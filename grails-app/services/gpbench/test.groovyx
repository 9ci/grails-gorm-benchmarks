package gpbench

import groovy.transform.CompileStatic

@CompileStatic
class CityNonFields {
    private String _name
    private String _state
    private String _country
    private String _zip

    String getName() { return _name }
    void setName(String n) { _name = n}

    String getState() { return _state }
    void setState(String n) { _state = n}

    String getCountry() { return _country }
    void setCountry(String n) { _country = n}

    String getZip() { return _zip }
    void setZip(String n) { _zip = n}

}

@CompileStatic
class CityTest {
    String name
    String state
    String country
    String zip
}

props = [name: "test", state: "Gujarat", country: "india", zip: "360007"]


void runBenchmark(Class clazz) {
    Long start = System.currentTimeMillis()
    for(int i in (1..1_000_00_0)) {
        def instance = clazz.newInstance()
        props.each {String k, String v ->
            def property = instance.hasProperty(k)
            assert property != null
            property.setProperty(instance, v)
        }
    }
    println "${clazz.simpleName} took ${(System.currentTimeMillis() - start)/1000}"
}

runBenchmark(CityNonFields)
runBenchmark(CityNonFields)

runBenchmark(CityTest)
runBenchmark(CityTest)â€‹

return 0
